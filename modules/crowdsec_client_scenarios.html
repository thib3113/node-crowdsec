<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>crowdsec-client-scenarios - v0.0.13 | Node CrowdSec Client</title><meta name="description" content="Documentation for Node CrowdSec Client"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Node CrowdSec Client</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">Node CrowdSec Client</a></li><li><a href="crowdsec_client_scenarios.html">crowdsec-client-scenarios</a></li></ul><h1>Module crowdsec-client-scenarios - v0.0.13</h1></div><section class="tsd-panel tsd-typography"><a id="md:crowdsec-client-scenarios" class="tsd-anchor"></a><h1 class="tsd-anchor-link">crowdsec-client-scenarios<a href="#md:crowdsec-client-scenarios" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://www.npmjs.com/package/crowdsec-client-scenarios" target="_blank" class="external"><img src="https://img.shields.io/npm/v/crowdsec-client-scenarios.svg" alt="NPM version"></a>
<a href="https://github.com/thib3113/node-crowdsec/actions/workflows/CI.yml" target="_blank" class="external"><img src="https://github.com/thib3113/node-crowdsec/actions/workflows/CI.yml/badge.svg" alt="CI"></a>
<a href="https://codecov.io/gh/thib3113/node-crowdsec" target="_blank" class="external"><img src="https://codecov.io/gh/thib3113/node-crowdsec/branch/main/graph/badge.svg?token=bQdlb31gcU" alt="codecov"></a>
<a href="https://www.npmjs.com/package/crowdsec-client-scenarios" target="_blank" class="external"><img src="https://img.shields.io/npm/dm/crowdsec-client-scenarios.svg" alt="Downloads"></a>
<a href="https://github.com/thib3113/node-crowdsec/blob/main/LICENSE" target="_blank" class="external"><img src="https://img.shields.io/npm/l/crowdsec-client-scenarios" alt="License"></a>
<a href="https://snyk.io/test/github/thib3113/node-crowdsec" target="_blank" class="external"><img src="https://snyk.io/test/github/thib3113/node-crowdsec/badge.svg" alt="Known Vulnerabilities"></a></p>
<p><a href="https://paypal.me/thib3113" target="_blank" class="external"><img src="https://img.shields.io/badge/Donate-PayPal-green.svg?logo=paypal" alt="Donate"></a>
<a href="https://github.com/thib3113/node-crowdsec/stargazers/" target="_blank" class="external"><img src="https://img.shields.io/github/stars/thib3113/node-crowdsec.svg?style=social&amp;label=Star" alt="GitHub stars"></a>
<a href="https://packagequality.com/#?package=crowdsec-client-scenarios" target="_blank" class="external"><img src="https://packagequality.com/shield/crowdsec-client-scenarios.svg" alt="Package Quality"></a></p>
<p><a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=bugs" alt="Bugs"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=code_smells" alt="Code Smells"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=duplicated_lines_density" alt="Duplicated Lines (%)"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=ncloc" alt="Lines of Code"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=sqale_rating" alt="Maintainability Rating"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=alert_status" alt="Quality Gate Status"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=reliability_rating" alt="Reliability Rating"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=security_rating" alt="Security Rating"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=sqale_index" alt="Technical Debt"></a>
<a href="https://sonarcloud.io/dashboard?id=thib3113_crowdsec-client-scenarios" target="_blank" class="external"><img src="https://sonarcloud.io/api/project_badges/measure?project=thib3113_crowdsec-client-scenarios&amp;metric=vulnerabilities" alt="Vulnerabilities"></a></p>
<p><img src="https://img.shields.io/badge/renovate-enabled-green?style=for-the-badge&amp;logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjUgNSAzNzAgMzcwIj48Y2lyY2xlIGN4PSIxODkiIGN5PSIxOTAiIHI9IjE4NCIgZmlsbD0iI2ZlMiIvPjxwYXRoIGZpbGw9IiM4YmIiIGQ9Ik0yNTEgMjU2bC0zOC0zOGExNyAxNyAwIDAxMC0yNGw1Ni01NmMyLTIgMi02IDAtN2wtMjAtMjFhNSA1IDAgMDAtNyAwbC0xMyAxMi05LTggMTMtMTNhMTcgMTcgMCAwMTI0IDBsMjEgMjFjNyA3IDcgMTcgMCAyNGwtNTYgNTdhNSA1IDAgMDAwIDdsMzggMzh6Ii8+PHBhdGggZmlsbD0iI2Q1MSIgZD0iTTMwMCAyODhsLTggOGMtNCA0LTExIDQtMTYgMGwtNDYtNDZjLTUtNS01LTEyIDAtMTZsOC04YzQtNCAxMS00IDE1IDBsNDcgNDdjNCA0IDQgMTEgMCAxNXoiLz48cGF0aCBmaWxsPSIjYjMwIiBkPSJNMjg1IDI1OGw3IDdjNCA0IDQgMTEgMCAxNWwtOCA4Yy00IDQtMTEgNC0xNiAwbC02LTdjNCA1IDExIDUgMTUgMGw4LTdjNC01IDQtMTIgMC0xNnoiLz48cGF0aCBmaWxsPSIjYTMwIiBkPSJNMjkxIDI2NGw4IDhjNCA0IDQgMTEgMCAxNmwtOCA3Yy00IDUtMTEgNS0xNSAwbC05LThjNSA1IDEyIDUgMTYgMGw4LThjNC00IDQtMTEgMC0xNXoiLz48cGF0aCBmaWxsPSIjZTYyIiBkPSJNMjYwIDIzM2wtNC00Yy02LTYtMTctNi0yMyAwLTcgNy03IDE3IDAgMjRsNCA0Yy00LTUtNC0xMSAwLTE2bDgtOGM0LTQgMTEtNCAxNSAweiIvPjxwYXRoIGZpbGw9IiNiNDAiIGQ9Ik0yODQgMzA0Yy00IDAtOC0xLTExLTRsLTQ3LTQ3Yy02LTYtNi0xNiAwLTIybDgtOGM2LTYgMTYtNiAyMiAwbDQ3IDQ2YzYgNyA2IDE3IDAgMjNsLTggOGMtMyAzLTcgNC0xMSA0em0tMzktNzZjLTEgMC0zIDAtNCAybC04IDdjLTIgMy0yIDcgMCA5bDQ3IDQ3YTYgNiAwIDAwOSAwbDctOGMzLTIgMy02IDAtOWwtNDYtNDZjLTItMi0zLTItNS0yeiIvPjxwYXRoIGZpbGw9IiMxY2MiIGQ9Ik0xNTIgMTEzbDE4LTE4IDE4IDE4LTE4IDE4em0xLTM1bDE4LTE4IDE4IDE4LTE4IDE4em0tOTAgODlsMTgtMTggMTggMTgtMTggMTh6bTM1LTM2bDE4LTE4IDE4IDE4LTE4IDE4eiIvPjxwYXRoIGZpbGw9IiMxZGQiIGQ9Ik0xMzQgMTMxbDE4LTE4IDE4IDE4LTE4IDE4em0tMzUgMzZsMTgtMTggMTggMTgtMTggMTh6Ii8+PHBhdGggZmlsbD0iIzJiYiIgZD0iTTExNiAxNDlsMTgtMTggMTggMTgtMTggMTh6bTU0LTU0bDE4LTE4IDE4IDE4LTE4IDE4em0tODkgOTBsMTgtMTggMTggMTgtMTggMTh6bTEzOS04NWwyMyAyM2M0IDQgNCAxMSAwIDE2TDE0MiAyNDBjLTQgNC0xMSA0LTE1IDBsLTI0LTI0Yy00LTQtNC0xMSAwLTE1bDEwMS0xMDFjNS01IDEyLTUgMTYgMHoiLz48cGF0aCBmaWxsPSIjM2VlIiBkPSJNMTM0IDk1bDE4LTE4IDE4IDE4LTE4IDE4em0tNTQgMThsMTgtMTcgMTggMTctMTggMTh6bTU1LTUzbDE4LTE4IDE4IDE4LTE4IDE4em05MyA0OGwtOC04Yy00LTUtMTEtNS0xNiAwTDEwMyAyMDFjLTQgNC00IDExIDAgMTVsOCA4Yy00LTQtNC0xMSAwLTE1bDEwMS0xMDFjNS00IDEyLTQgMTYgMHoiLz48cGF0aCBmaWxsPSIjOWVlIiBkPSJNMjcgMTMxbDE4LTE4IDE4IDE4LTE4IDE4em01NC01M2wxOC0xOCAxOCAxOC0xOCAxOHoiLz48cGF0aCBmaWxsPSIjMGFhIiBkPSJNMjMwIDExMGwxMyAxM2M0IDQgNCAxMSAwIDE2TDE0MiAyNDBjLTQgNC0xMSA0LTE1IDBsLTEzLTEzYzQgNCAxMSA0IDE1IDBsMTAxLTEwMWM1LTUgNS0xMSAwLTE2eiIvPjxwYXRoIGZpbGw9IiMxYWIiIGQ9Ik0xMzQgMjQ4Yy00IDAtOC0yLTExLTVsLTIzLTIzYTE2IDE2IDAgMDEwLTIzTDIwMSA5NmExNiAxNiAwIDAxMjIgMGwyNCAyNGM2IDYgNiAxNiAwIDIyTDE0NiAyNDNjLTMgMy03IDUtMTIgNXptNzgtMTQ3bC00IDItMTAxIDEwMWE2IDYgMCAwMDAgOWwyMyAyM2E2IDYgMCAwMDkgMGwxMDEtMTAxYTYgNiAwIDAwMC05bC0yNC0yMy00LTJ6Ii8+PC9zdmc+" alt="Dependencies update - renovate"></p>
<p><a href="https://nodei.co/npm/crowdsec-client-scenarios/" target="_blank" class="external"><img src="https://nodei.co/npm/crowdsec-client-scenarios.png" alt="NPM"></a></p>
<p>This library is a Node.js client to talk with crowdsec rest API .</p>
<a id="md:start" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Start<a href="#md:start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>install it</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1"> </span><span class="hl-0">crowdsec</span><span class="hl-1">-</span><span class="hl-0">client</span><span class="hl-1">-</span><span class="hl-0">scenarios</span>
</code><button>Copy</button></pre>

<p>and then read the documentation in the <a href="https://github.com/thib3113/node-crowdsec/wiki" target="_blank" class="external">wiki</a></p>
<a id="md:usage" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Usage<a href="#md:usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This package, is planned to host scenarios used by <a href="https://www.npmjs.com/package/crowdsec-http-middleware" target="_blank" class="external">crowdsec-http-middleware</a> and other middleware that extend it</p>
<a id="md:scenarios" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Scenarios<a href="#md:scenarios" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>in this part, we will use the variables <code>scenarios</code> and <code>scenariosOptions</code>, to illustrate the use in the middlewares</p>
<a id="md:defaults-scenarios" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Defaults scenarios<a href="#md:defaults-scenarios" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>the defaults scenarios are (<a href="https://github.com/thib3113/node-crowdsec/blob/main/packages/crowdsec-client-scenarios/src/index.ts#L8" target="_blank" class="external">defined here</a>) :</p>
<ul>
<li><a href="#md:allowlist">AllowListEnricher</a> : allow you to skip alerts on your local ips</li>
<li><a href="#md:xforwardedforchecker">XForwardedForChecker</a> : allow to extract visitor ip</li>
<li><a href="#md:httpenricher">HTTPEnricher</a> : enrich alerts with information from the http request</li>
</ul>
<a id="md:available-scenarios" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Available scenarios<a href="#md:available-scenarios" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The available scenarios are :</p>
<a id="md:xforwardedforchecker" class="tsd-anchor"></a><h3 class="tsd-anchor-link">XForwardedForChecker<a href="#md:xforwardedforchecker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This scenario will validate the XForwardedFor header . Some malicious persons will send you a fake <code>X-Forwarded-For</code> header, to hide their real IP .
This scenario will trigger an alert, if an untrusted IP try to pass <code>X-Forwarded-For</code></p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenarios</span><span class="hl-1"> = [</span><span class="hl-0">XForwardedForChecker</span><span class="hl-1">];</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-5">&#39;x-forwarded-for&#39;</span><span class="hl-0">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">//list of trusted CIDR, you need to setup here that all the trusted proxies, else, it will trigger alert for your reverse proxies, and extract incorrect ip</span><br/><span class="hl-1">        </span><span class="hl-0">trustedProxies:</span><span class="hl-1"> [],</span><br/><span class="hl-1">        </span><span class="hl-6">//trigger alert if an untrusted ip set the header (true by default)</span><br/><span class="hl-1">        </span><span class="hl-0">alertOnNotTrustedIps:</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>this scenario support the extractIp capability, so, if you enable it, it will extract the IP automatically from the headers, will use set it on <code>req.ip</code>, and will use it to trigger alerts and check if decisions exists</p>
<a id="md:example" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Example<a href="#md:example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>you are using cloudflare (you can get cloudflare <a href="https://www.cloudflare.com/fr-fr/ips/" target="_blank" class="external">ips</a> here, then traefik in subnet 10.0.3.0/24, and finally your webserver</p>
<p>on your server, you will configure :</p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenarios</span><span class="hl-1"> = [</span><span class="hl-0">XForwardedForChecker</span><span class="hl-1">];</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-5">&#39;x-forwarded-for&#39;</span><span class="hl-0">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">//list of trusted CIDR, you need to setup here that all the trusted proxies, else, it will trigger alert for your reverse proxies, and extract incorrect ip</span><br/><span class="hl-1">        </span><span class="hl-0">trustedProxies:</span><span class="hl-1"> [</span><br/><span class="hl-1">            </span><span class="hl-6">//cloudflare ips</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;173.245.48.0/20&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;103.21.244.0/22&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;103.22.200.0/22&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;103.31.4.0/22&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;141.101.64.0/18&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;108.162.192.0/18&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;190.93.240.0/20&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;188.114.96.0/20&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;197.234.240.0/22&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;198.41.128.0/17&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;162.158.0.0/15&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;104.16.0.0/13&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;104.24.0.0/14&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;172.64.0.0/13&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;131.0.72.0/22&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2400:cb00::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2606:4700::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2803:f800::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2405:b500::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2405:8100::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2a06:98c0::/29&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;2c0f:f248::/32&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-6">//traefik ip</span><br/><span class="hl-1">            </span><span class="hl-5">&quot;10.0.3.0/24&quot;</span><br/><span class="hl-1">        ],</span><br/><span class="hl-1">        </span><span class="hl-6">//trigger alert if an untrusted ip set the header</span><br/><span class="hl-1">        </span><span class="hl-0">alertOnNotTrustedIps:</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>so, if someone with ip <code>1.2.3.4</code> it will produce an <code>X-Forwarded-For</code> like <code>1.2.3.4, 173.245.48.2</code>, and your webserver will detect a remote address like <code>10.0.3.1</code> .
This scenario will parse the information, and so set <code>req.ip = &quot;1.2.3.4&quot;</code>, so you now know the real ip of your visitor .</p>
<p>I need to warn you, if you miss configured the list of allowed ips, it can ban your reverse proxy .
you can test it before, by setting <code>alertOnNotTrustedIps</code> to false, and log <code>req.ip</code>, if the IP is correct, you can enable the alerts</p>
<a id="md:allowlist" class="tsd-anchor"></a><h3 class="tsd-anchor-link">AllowList<a href="#md:allowlist" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This scenario allow you to exclude some ips from alerts</p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenarios</span><span class="hl-1"> = [</span><span class="hl-0">AllowListEnricher</span><span class="hl-1">];</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-5">&#39;allow-list&#39;</span><span class="hl-0">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">//list of CIDR/IP to allow to skip alert checks</span><br/><span class="hl-1">        </span><span class="hl-0">allowed:</span><span class="hl-1"> [</span><span class="hl-5">&#39;127.0.0.1&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>by default, the CIDR allowed are the <a href="https://en.wikipedia.org/wiki/Private_network" target="_blank" class="external">RFC 1918</a> one (private network)</p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-5">&#39;allow-list&#39;</span><span class="hl-0">:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">allowed:</span><span class="hl-1"> [</span><span class="hl-5">&#39;127.0.0.1&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;::1&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;192.168.0.0/16&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;10.0.0.0/8&#39;</span><span class="hl-1">, </span><span class="hl-5">&#39;172.16.0.0/12&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:httpenricher" class="tsd-anchor"></a><h3 class="tsd-anchor-link">HTTPEnricher<a href="#md:httpenricher" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>this scenario will add context to your alert, linked with the current http request</p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenarios</span><span class="hl-1"> = [</span><span class="hl-0">AllowListEnricher</span><span class="hl-1">];</span><br/><span class="hl-6">//no options</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {}</span>
</code><button type="button">Copy</button></pre>

<a id="md:maxmindenricher" class="tsd-anchor"></a><h3 class="tsd-anchor-link">MaxMindEnricher<a href="#md:maxmindenricher" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>this scenario will add context to your alert with the help of the maxmind databases</p>
<pre><code class="typescript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenarios</span><span class="hl-1"> = [</span><span class="hl-0">MaxMindEnricher</span><span class="hl-1">];</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">scenariosOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-0">maxmind:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">//specify path to ASN or city databases . you need need to set one, or the two databases</span><br/><span class="hl-1">        </span><span class="hl-0">paths:</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">ASN:</span><span class="hl-1"> </span><span class="hl-5">&#39;path/to/geoLite2-ASN.mmdb&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">city:</span><span class="hl-1"> </span><span class="hl-5">&#39;path/to/geoLite2-City.mmdb&#39;</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        </span><span class="hl-6">//you can watch for updates, and so, updating the database on the filesytem will automatically reload the database</span><br/><span class="hl-1">        </span><span class="hl-0">watchForUpdates:</span><span class="hl-1"> </span><span class="hl-2">true</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>to use this scenario, you will need to download free databases available <a href="http://dev.maxmind.com/geoip/geoip2/geolite2/" target="_blank" class="external">here</a>.
If you need better accuracy you should consider buying <a href="https://www.maxmind.com/en/geoip2-databases" target="_blank" class="external">commercial subscription</a>.</p>
<a id="md:debug" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Debug<a href="#md:debug" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>this library include <a href="https://www.npmjs.com/package/debug" target="_blank" class="external">debug</a>, to debug, you can set the env variable :</p>
<pre><code class="dotenv">DEBUG=crowdsec-client-scenarios:*
</code><button type="button">Copy</button></pre>

</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Classes</h3><div class="tsd-index-list"><a href="../classes/crowdsec_client_scenarios.AllowListEnricher.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Allow<wbr/>List<wbr/>Enricher</span></a>
<a href="../classes/crowdsec_client_scenarios.BaseScenario.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Base<wbr/>Scenario</span></a>
<a href="../classes/crowdsec_client_scenarios.HTTPEnricher.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>HTTPEnricher</span></a>
<a href="../classes/crowdsec_client_scenarios.MaxMindEnricher.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>Max<wbr/>Mind<wbr/>Enricher</span></a>
<a href="../classes/crowdsec_client_scenarios.XForwardedForChecker.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-128"></use></svg><span>XForwarded<wbr/>For<wbr/>Checker</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Interfaces</h3><div class="tsd-index-list"><a href="../interfaces/crowdsec_client_scenarios.IExtractedIP.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IExtractedIP</span></a>
<a href="../interfaces/crowdsec_client_scenarios.IIpExtractionResult.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IIp<wbr/>Extraction<wbr/>Result</span></a>
<a href="../interfaces/crowdsec_client_scenarios.IMaxMindOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IMax<wbr/>Mind<wbr/>Options</span></a>
<a href="../interfaces/crowdsec_client_scenarios.IScenario.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IScenario</span></a>
<a href="../interfaces/crowdsec_client_scenarios.IScenarioOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IScenario<wbr/>Options</span></a>
<a href="../interfaces/crowdsec_client_scenarios.IXForwardedForOptions.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>IXForwarded<wbr/>For<wbr/>Options</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Type Aliases</h3><div class="tsd-index-list"><a href="../types/crowdsec_client_scenarios.IScenarioConstructor.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>IScenario<wbr/>Constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Variables</h3><div class="tsd-index-list"><a href="../variables/crowdsec_client_scenarios.MAX_CONFIDENCE.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-32"></use></svg><span>MAX_<wbr/>CONFIDENCE</span></a>
<a href="../variables/crowdsec_client_scenarios.scenarios.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-32"></use></svg><span>scenarios</span></a>
<a href="../variables/crowdsec_client_scenarios.VERSION.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-32"></use></svg><span>VERSION</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:crowdsec-client-scenarios"><span>crowdsec-<wbr/>client-<wbr/>scenarios</span></a><a href="#md:start"><span>Start</span></a><a href="#md:usage"><span>Usage</span></a><a href="#md:scenarios"><span>Scenarios</span></a><ul><li><a href="#md:defaults-scenarios"><span>Defaults scenarios</span></a></li><li><a href="#md:available-scenarios"><span>Available scenarios</span></a></li><li><ul><li><a href="#md:xforwardedforchecker"><span>XForwarded<wbr/>For<wbr/>Checker</span></a></li><li><ul><li><a href="#md:example"><span>Example</span></a></li></ul></li><li><a href="#md:allowlist"><span>Allow<wbr/>List</span></a></li><li><a href="#md:httpenricher"><span>HTTPEnricher</span></a></li><li><a href="#md:maxmindenricher"><span>Max<wbr/>Mind<wbr/>Enricher</span></a></li></ul></li><li><a href="#md:debug"><span>Debug</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>Node CrowdSec Client</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
